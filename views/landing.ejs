<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Ella Rises - Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="bg-light">
  <div class="container py-4">

    <!-- HEADER -->
    <header class="d-flex justify-content-between align-items-center mb-4">
      <div>
        <h1 class="h3 mb-0" style="font-family:'DM Serif Display',serif;">Ella Rises</h1>
        <small class="text-muted">Dashboard</small>
      </div>

      <div class="text-end">
        <% if (!loggedInLevel) { %>
          <!-- Public visitor -->
          <a class="btn btn-outline-secondary btn-sm" href="/login">
            User / Manager Login
          </a>

        <% } else { %>
          <!-- Logged-in user or manager -->
          <div class="mb-1">
            Logged in as <strong><%= loggedInLevel === 'M' ? 'Manager' : 'User' %></strong>
          </div>
          <a class="btn btn-outline-secondary btn-sm" href="/logout">
            Logout
          </a>
        <% } %>
      </div>
    </header>

    <!-- DASHBOARD STATS -->
    <div class="row mb-4">
      <div class="col-md-3 mb-3">
        <div class="card text-center shadow-sm">
          <div class="card-body">
            <div class="text-muted small text-uppercase">Participants</div>
            <div class="display-6"><%= stats.participants %></div>
          </div>
        </div>
      </div>

      <div class="col-md-3 mb-3">
        <div class="card text-center shadow-sm">
          <div class="card-body">
            <div class="text-muted small text-uppercase">Events</div>
            <div class="display-6"><%= stats.events %></div>
          </div>
        </div>
      </div>

      <div class="col-md-3 mb-3">
        <div class="card text-center shadow-sm">
          <div class="card-body">
            <div class="text-muted small text-uppercase">Donations</div>
            <div class="display-6">$<%= stats.donationsTotal %></div>
          </div>
        </div>
      </div>

      <div class="col-md-3 mb-3">
        <div class="card text-center shadow-sm">
          <div class="card-body">
            <div class="text-muted small text-uppercase">Surveys</div>
            <div class="display-6"><%= stats.surveys %></div>
          </div>
        </div>
      </div>
    </div>

    <!-- MANAGE DATA LINKS -->
    <h2 class="h5 mb-3">Manage data</h2>

    <% if (loggedInLevel === 'M') { %>
      <!-- MANAGER VIEW -->
      <div class="list-group mb-4">
        <a class="list-group-item list-group-item-action"
           href="/participants?userId=<%= loggedInUserId %>&level=<%= loggedInLevel %>">Participants</a>

        <a class="list-group-item list-group-item-action"
           href="/events?userId=<%= loggedInUserId %>&level=<%= loggedInLevel %>">Events</a>

        <a class="list-group-item list-group-item-action"
           href="/surveys?userId=<%= loggedInUserId %>&level=<%= loggedInLevel %>">Surveys</a>

        <a class="list-group-item list-group-item-action"
           href="/milestones?userId=<%= loggedInUserId %>&level=<%= loggedInLevel %>">Milestones</a>

        <a class="list-group-item list-group-item-action"
           href="/donations?userId=<%= loggedInUserId %>&level=<%= loggedInLevel %>">Donations</a>
      </div>

    <% } else if (loggedInLevel === 'U') { %>
      <!-- USER VIEW (read-only) -->
      <div class="list-group mb-4">
        <a class="list-group-item list-group-item-action" href="/participants">Participants</a>
        <a class="list-group-item list-group-item-action" href="/events">Events</a>
        <a class="list-group-item list-group-item-action" href="/surveys">Surveys</a>
        <a class="list-group-item list-group-item-action" href="/milestones">Milestones</a>
        <a class="list-group-item list-group-item-action" href="/donations">Donations</a>
      </div>

    <% } else { %>
      <!-- PUBLIC VISITOR VIEW -->
      <p class="text-muted">
        Log in to access participant, event, survey, milestone, and donation tools.
      </p>
    <% } %>

    <!-- PUBLIC DONATION BUTTON -->
    <div class="mb-3">
      <a class="btn btn-primary" href="/donate">Public donation page</a>
    </div>

  </div>
</body>
</html>
